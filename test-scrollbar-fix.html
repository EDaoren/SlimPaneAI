<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä»£ç å—æ»šåŠ¨æ¡ä¿®å¤æµ‹è¯•</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://unpkg.com/highlightjs-copy/dist/highlightjs-copy.min.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 2rem;
            background: #f8fafc;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 1rem;
            padding: 2rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        h1 {
            color: #1e293b;
            margin-bottom: 2rem;
            text-align: center;
        }

        .test-section {
            margin-bottom: 2rem;
            padding: 1rem;
            border: 1px solid #e2e8f0;
            border-radius: 0.5rem;
            background: #f8fafc;
        }

        .test-section h2 {
            color: #475569;
            margin-top: 0;
            margin-bottom: 1rem;
        }

        .status {
            padding: 1rem;
            border-radius: 0.5rem;
            margin: 1rem 0;
            font-weight: 500;
            background: #dbeafe;
            border: 1px solid #bfdbfe;
            color: #1e40af;
        }

        .error {
            background: #fef2f2;
            border-color: #fecaca;
            color: #dc2626;
        }

        /* åº”ç”¨ä¿®å¤åçš„æ ·å¼ */
        .hljs {
            display: block !important;
            overflow-x: hidden !important;
            padding: 0.5em !important;
            color: #c9d1d9 !important;
            background: #0d1117 !important;
            /* é˜²æ­¢æ»šåŠ¨æ¡å¯¼è‡´çš„æŠ–åŠ¨ */
            scrollbar-width: none !important;
            -ms-overflow-style: none !important;
            border-radius: 0.5rem;
            margin: 0.5rem 0;
        }

        /* éšè—ä»£ç å—çš„æ»šåŠ¨æ¡ */
        .hljs::-webkit-scrollbar {
            display: none !important;
        }

        pre:not(.hljs) {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            padding: 12px;
            overflow-x: hidden;
            font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
            font-size: 13px;
            line-height: 1.4;
            /* é˜²æ­¢æ»šåŠ¨æ¡å¯¼è‡´çš„æŠ–åŠ¨ */
            scrollbar-width: none;
            -ms-overflow-style: none;
        }

        /* éšè—æ™®é€š pre å…ƒç´ çš„æ»šåŠ¨æ¡ */
        pre:not(.hljs)::-webkit-scrollbar {
            display: none;
        }

        .test-info {
            background: #f0f9ff;
            border: 1px solid #bae6fd;
            border-radius: 0.5rem;
            padding: 1rem;
            margin: 1rem 0;
            color: #0369a1;
        }

        .test-info ul {
            margin: 0.5rem 0;
            padding-left: 1.5rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”§ ä»£ç å—æ»šåŠ¨æ¡ä¿®å¤æµ‹è¯•</h1>
        
        <div class="test-info">
            <h3>ä¿®å¤å†…å®¹ï¼š</h3>
            <ul>
                <li>âœ… ç§»é™¤çŸ­ä»£ç å—çš„ä¸å¿…è¦æ»šåŠ¨æ¡</li>
                <li>âœ… é˜²æ­¢é¼ æ ‡æ‚¬åœæ—¶çš„é¡µé¢æŠ–åŠ¨</li>
                <li>âœ… ä¿æŒä»£ç å—çš„æ­£å¸¸æ˜¾ç¤ºå’Œå¤åˆ¶åŠŸèƒ½</li>
                <li>âœ… ä¼˜åŒ–ä»£ç å—çš„è§†è§‰æ•ˆæœ</li>
            </ul>
        </div>

        <div id="fix-status" class="status">æ­£åœ¨æµ‹è¯•ä¿®å¤æ•ˆæœ...</div>

        <div class="test-section">
            <h2>çŸ­ä»£ç ç¤ºä¾‹ï¼ˆä¸åº”è¯¥æœ‰æ»šåŠ¨æ¡ï¼‰</h2>
            <pre><code class="language-bash">docker compose ps</code></pre>
        </div>

        <div class="test-section">
            <h2>ç¨é•¿çš„ä»£ç ç¤ºä¾‹</h2>
            <pre><code class="language-bash">docker compose logs -f ept-load</code></pre>
        </div>

        <div class="test-section">
            <h2>JavaScript ä»£ç ç¤ºä¾‹</h2>
            <pre><code class="language-javascript">// æµ‹è¯•ä»£ç é«˜äº®å’Œå¤åˆ¶åŠŸèƒ½
const message = "Hello, World!";
console.log(message);</code></pre>
        </div>

        <div class="test-section">
            <h2>CSS ä»£ç ç¤ºä¾‹</h2>
            <pre><code class="language-css">/* ä¿®å¤åçš„æ ·å¼ */
.hljs {
  overflow-x: hidden !important;
  scrollbar-width: none !important;
}</code></pre>
        </div>

        <div class="test-section">
            <h2>é¼ æ ‡æ‚¬åœæµ‹è¯•</h2>
            <p>è¯·å°†é¼ æ ‡ç§»åŠ¨åˆ°ä¸‹é¢çš„ä»£ç å—ä¸Šï¼Œè§‚å¯Ÿæ˜¯å¦æœ‰æŠ–åŠ¨ï¼š</p>
            <pre><code class="language-python">print("æµ‹è¯•é¼ æ ‡æ‚¬åœæ•ˆæœ")</code></pre>
        </div>
    </div>

    <script>
        // åˆå§‹åŒ– highlightjs-copy æ’ä»¶
        hljs.addPlugin(new CopyButtonPlugin({
            lang: 'zh-CN',
            callback: (text, el) => {
                console.log('ä»£ç å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
                updateStatus('âœ… ä»£ç å¤åˆ¶æˆåŠŸï¼æ»šåŠ¨æ¡ä¿®å¤æ•ˆæœæ­£å¸¸ã€‚', false);
            }
        }));

        // é«˜äº®æ‰€æœ‰ä»£ç å—
        hljs.highlightAll();

        function updateStatus(message, isError = false) {
            const statusEl = document.getElementById('fix-status');
            statusEl.textContent = message;
            statusEl.className = isError ? 'status error' : 'status';
        }

        // æ£€æŸ¥ä¿®å¤æ•ˆæœ
        setTimeout(() => {
            const codeBlocks = document.querySelectorAll('.hljs');
            const copyButtons = document.querySelectorAll('.hljs-copy-button');
            
            console.log(`æ‰¾åˆ° ${codeBlocks.length} ä¸ªä»£ç å—`);
            console.log(`æ‰¾åˆ° ${copyButtons.length} ä¸ªå¤åˆ¶æŒ‰é’®`);
            
            // æ£€æŸ¥æ»šåŠ¨æ¡æ˜¯å¦è¢«éšè—
            let hasScrollbar = false;
            codeBlocks.forEach(block => {
                const computedStyle = window.getComputedStyle(block);
                const overflowX = computedStyle.overflowX;
                const scrollbarWidth = computedStyle.scrollbarWidth;
                
                console.log('ä»£ç å—æ ·å¼:', {
                    overflowX,
                    scrollbarWidth,
                    scrollWidth: block.scrollWidth,
                    clientWidth: block.clientWidth
                });
                
                if (overflowX === 'auto' || overflowX === 'scroll') {
                    hasScrollbar = true;
                }
            });
            
            if (codeBlocks.length > 0 && copyButtons.length > 0 && !hasScrollbar) {
                updateStatus(`âœ… æ»šåŠ¨æ¡ä¿®å¤æˆåŠŸï¼æ‰¾åˆ° ${codeBlocks.length} ä¸ªä»£ç å—å’Œ ${copyButtons.length} ä¸ªå¤åˆ¶æŒ‰é’®ã€‚æ»šåŠ¨æ¡å·²éšè—ï¼Œä¸ä¼šäº§ç”ŸæŠ–åŠ¨ã€‚`);
            } else if (hasScrollbar) {
                updateStatus('âš ï¸ éƒ¨åˆ†ä»£ç å—ä»ç„¶æ˜¾ç¤ºæ»šåŠ¨æ¡ï¼Œè¯·æ£€æŸ¥CSSæ ·å¼ã€‚', true);
            } else {
                updateStatus('âŒ ä»£ç é«˜äº®æˆ–å¤åˆ¶åŠŸèƒ½å¼‚å¸¸ï¼Œè¯·æ£€æŸ¥é…ç½®ã€‚', true);
            }
        }, 1000);

        // ç›‘å¬é¼ æ ‡äº‹ä»¶ï¼Œæ£€æµ‹æŠ–åŠ¨
        let mouseEnterCount = 0;
        document.addEventListener('mouseenter', (e) => {
            if (e.target.classList.contains('hljs')) {
                mouseEnterCount++;
                console.log(`é¼ æ ‡è¿›å…¥ä»£ç å— ${mouseEnterCount} æ¬¡`);
            }
        }, true);
    </script>
</body>
</html>
